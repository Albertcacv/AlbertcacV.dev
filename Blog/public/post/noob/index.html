<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <script
    type="application/javascript"
    src='blog.albertcacv.dev/js/theme-mode.js'
  ></script>
  <link rel="stylesheet" href='blog.albertcacv.dev/css/frameworks.min.css' />
  <link rel="stylesheet" href='blog.albertcacv.dev/css/github.min.css' />
  <link rel="stylesheet" href='blog.albertcacv.dev/css/github-style.css' />
  <link rel="stylesheet" href='blog.albertcacv.dev/css/light.css' />
  <link rel="stylesheet" href='blog.albertcacv.dev/css/dark.css' />
  <link rel="stylesheet" href='blog.albertcacv.dev/css/syntax.css' />
  <title>
    Noob - HMV - Albertcacv | Blog
  </title>
  
  <link rel="icon" type="image/x-icon" href="/images/favicon.jpg" />
  
  <meta name="theme-color" content="#1e2327" />

  
  <meta name="description"
  content="Write up of the HackMyVM platform Noob machine" />
<meta name="keywords"
  content=', ' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="blog.albertcacv.dev/post/noob/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Noob - HMV - Albertcacv | Blog" />
<meta name="twitter:description"
  content="Write up of the HackMyVM platform Noob machine" />
<meta name="twitter:site" content="blog.albertcacv.dev" />
<meta name="twitter:creator" content="AlbertcacV" />
<meta name="twitter:image"
  content="blog.albertcacv.dev">


<meta property="og:type" content="article" />
<meta property="og:title" content="Noob - HMV - Albertcacv | Blog">
<meta property="og:description"
  content="Write up of the HackMyVM platform Noob machine" />
<meta property="og:url" content="blog.albertcacv.dev/post/noob/" />
<meta property="og:site_name" content="Noob - HMV" />
<meta property="og:image"
  content="blog.albertcacv.dev">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2021-09-04 19:10:30 &#43;0200 CEST" />










</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="blog.albertcacv.dev">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:blog.albertcacv.dev">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="blog.albertcacv.dev">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="blog.albertcacv.dev">
                  <img class=" avatar-user"
                    src="blog.albertcacv.dev/images/avatar.jpg"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="blog.albertcacv.dev">AlbertcacV</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="blog.albertcacv.dev/post/noob/">Noob - HMV</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Sat, 04 Sep 2021 19:10:30 &#43;0200"
                    class="no-wrap">
                    Sat, 04 Sep 2021 19:10:30 &#43;0200</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Wed, 15 Sep 2021 21:19:02 &#43;0200"
                    class="no-wrap">
                    Wed, 15 Sep 2021 21:19:02 &#43;0200</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" class="btn btn-octicon m-0 mr-2 p-2" aria-haspopup="menu" aria-label="Table of Contents" role="button">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                          748 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5">
                <article class="markdown-body entry-content container-lg"><h1 id="fase-de-reconocimiento">Fase de reconocimiento</h1>
<p>En primer lugar, lanzamos una traza ICMP a la máquina para comprobar que esta activa.</p>
<p><img src="/images/Noob-HMV/traza_ICMP.png" alt=""></p>
<p>Debido al ttl, sabemos que estamos ante una máquina Windows.</p>
<h2 id="1-enumeración">1. Enumeración</h2>
<p><img src="/images/Noob-HMV/1nmap.png" alt=""></p>
<p>Para un primer reconicimento hacemos uso de la herramienta nmap seguida de los siguientes parametros:</p>
<ul>
<li>-p- : Para escanear todo el rango de puertos, es decir, los 65535 puertos.</li>
<li>&ndash;open : Para filtrar por aquellos puertos que esten abiertos.</li>
<li>-T5 : Para acelerar el tiempo de escaneo. Recuerda que este parámetro admite valores desde el 0-5. Para este caso, dado que estamos en un entorno controlado, el uso de este parámetro tan alto es seguro.</li>
<li>-v : Indica verbosidad, es decir, nos reporta por consola los matches para no tener que esperar a que finalice el proceso.</li>
<li>-n : Para evitar la resolución de DNS</li>
</ul>
<p>Si resulta que el escaneo es demasiado lento, en algunos casos es lo normal, podemos hacer uso de un escaneo llamado &ldquo;SyncPort Scan&rdquo;. Para ello, empleamos <code>-sS --min-rate 500</code> y como paso final exportamos las evidencias a un archivo de nombre nmap por ejemplo.</p>
<p><img src="/images/Noob-HMV/2nmap.png" alt=""></p>
<p>Como resultado de este escaneo, obtenemos el puerto 22(SSH) y el puerto 65530.
Una vez obtenidos estos puertos, vamos a proceder a conocer su version y y mediante una serie de scripts básicos de enumeracion ver que servicios corresponden a esos puertos:</p>
<p><img src="/images/Noob-HMV/targetedPorts.png" alt=""></p>
<p>Vemos que el puerto 22 corresponde a un servicio ssh y el puerto 65530, el cual, antes no sabiamos que servicio tenia, descubrimos que corresponde aun servidor http.</p>
<p>A partir de aqui, podemos usar herramientas como whatweb y wfuzz o gobuster para el fuzzing de directorios. En mi caso, utilizaré gobuster pero puedes utilizar aquella con la que mas agusto te encuentres.</p>
<p><img src="/images/Noob-HMV/whatweb.png" alt=""></p>
<p>Como whatweb no nos reporta nada interesante, vamos a probar a fuzzear directorios de la web.</p>
<p>Podemos usar los scripts de nmap para un primer fuzzeo, es posible que con este escaneo sea suficiente y si no, empleamos gobuster.</p>
<p><img src="/images/Noob-HMV/httpEnum.png" alt="">
Los scripts de nmap tampoco nos reportan nada interesante asi que es momento de aplicar gobuster.</p>
<p><img src="/images/Noob-HMV/gobuster.png" alt=""></p>
<p>con el reporte de gobuster vemos un directorio que resulta atractivo =&gt; nt4share.
Una buena idea sería realizar un segundo fuzzzing sobre este directorio para ver si oculta algo importante que nos sea útil.
No obstante, si entramos en la web vemos un directory listing donde encontramos algo bastente relevante:</p>
<p><img src="/images/Noob-HMV/n4tshare.png" alt=""></p>
<p>Dentro encontramos una clave id_rsa y una clave id_rsa.pub.
Si entramos en cada uno de estos fichero encontraremos una id_rsa y un nombre de usuario respectivamente.</p>
<p><img src="/images/Noob-HMV/id_rsa.png" alt="">
<img src="/images/Noob-HMV/userFound.png" alt=""></p>
<h2 id="2-explotación">2. Explotación</h2>
<p>Para poder hacer uso de la clave id_rsa, vamos a descargarla y darle los permisos necesarios.</p>
<p>Con curl vamos a proceder a descargar la clave y la guardamos en un archivo con nombre sshkey:
<img src="/images/Noob-HMV/curl.png" alt=""></p>
<p>Una vez tenemos la clave descargada y hemos proporcionado los permisos necesarios(600), vamos a proceder a conectarnos por ssh y como usuario sabemos que existe un usario adela:</p>
<p><img src="/images/Noob-HMV/adelassh.png" alt=""></p>
<p>Tenemos acceso a la máquina víctima por ssh.</p>
<h2 id="3-escalada-de-privilegios">3. Escalada de privilegios</h2>
<p>Como usuario adela debemos hacernos con el usuario root.</p>
<p>Veamos que procesos estan corriendo bajo el usuario root, encontrando dos que son de gran interés:
<img src="/images/Noob-HMV/psaux.png" alt=""></p>
<p>Como sabemos que podemos leer archivos en /home/adela podemos crear un enlace simbolico hacia otro archivo y despues, tratar de leerlo. En este caso, la idea es hacer un enlace simbolico de la id_rsa del usuario root para poder leerla.</p>
<p><img src="/images/Noob-HMV/id_rsaRoot.png" alt=""></p>
<p>Ahora podemos leer la clave id_rsa desde el usuario Adela. Ahora solo queda repetir el proceso anterior y podriamos completar la escalada. Vamos a ello!</p>
<p>Descargamos la clave id_rsa con curl:
<img src="/images/Noob-HMV/rootKey.png" alt=""></p>
<p>Damos los permisos necesarios(600) y nos conectamos por ssh:</p>
<p><img src="/images/Noob-HMV/rootSession.png" alt=""></p>
<p>También nos podriamos haber conectado desde la sesión de adela si nos hubiesemos copiado la clave id_rsa como un archivo en nano y hubiesemos procedido de la misma manera.</p>
<p>Como usuario root que somos, ya podemos entrar el directorio root y ver la flag.</p>
<p><img src="/images/Noob-HMV/rootKeys.png" alt=""></p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script>
 
 
 
 window.onload = function () {
   const header = document.getElementById('post-header');
   const headerHeight = header.offsetHeight;
   
   document.documentElement.style.scrollPaddingTop = headerHeight + 10 + "px";
 }

 const tocToggleButton = document.getElementById("toc-toggle");

 const tippyInstance = tippy('#toc-toggle', {
  trigger: 'click',
  content: '<div id="table-of-contents">\x3cnav id=\x22TableOfContents\x22\x3e\n  \x3cul\x3e\n    \x3cli\x3e\x3ca href=\x22#1-enumeración\x22\x3e1. Enumeración\x3c\/a\x3e\x3c\/li\x3e\n    \x3cli\x3e\x3ca href=\x22#2-explotación\x22\x3e2. Explotación\x3c\/a\x3e\x3c\/li\x3e\n    \x3cli\x3e\x3ca href=\x22#3-escalada-de-privilegios\x22\x3e3. Escalada de privilegios\x3c\/a\x3e\x3c\/li\x3e\n  \x3c\/ul\x3e\n\x3c\/nav\x3e</div>',
  allowHTML: true,
  placement: 'bottom-start',
  interactive: true,
  arrow: false,
  maxWidth: "none",
  onHide: function () { tocToggleButton.classList.remove("hover"); },
  onShow: function () { tocToggleButton.classList.add("hover"); },
  onShown: function () {
    selectTableOfContentsOption();

    if (window.hasSetupTableOfContentsListeners) {
      return;
    }

    const tableOfContents = document.getElementById("table-of-contents");
    tableOfContents.addEventListener('click', function () {
      
      tippyInstance[0].hide();
    });

    window.hasSetupTableOfContentsListeners = true;
  }
 });

 function selectTableOfContentsOption () {
   const optionSelectedClass = 'table-of-contents-option-selected';

   const tableOfContentsOptions = document.querySelectorAll("#table-of-contents > nav > ul li");

   for (const option of tableOfContentsOptions) {
     

     const [child] = option.children;
     if (child.tagName.toLowerCase() !== 'a') {
       continue;
     }

     if (window.location.href === child.href) {
       child.classList.add(optionSelectedClass);
     } else {
       child.classList.remove(optionSelectedClass);
     }
   }
 }

 window.onhashchange = selectTableOfContentsOption;
</script>


</body>

<script type="application/javascript" src="blog.albertcacv.dev/js/github-style.js"></script>



</html>